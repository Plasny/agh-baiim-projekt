<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>BAIM Projekt - TASK 4</title>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            loadPage = document.getElementById("loadPage");
            frame = document.getElementById("resultFrame");
            checkAnswer = document.getElementById("checkAnswer");
            loadPage.addEventListener("click", function () {
                const siteContent = document.getElementById("siteContent").value;
                const blob = new Blob([siteContent], {type: 'text/html'});
                const url = URL.createObjectURL(blob);
                frame.src = url;
            });
            checkAnswer.addEventListener("click", function () {
                fetch('/session')
                    .then(response => response.json())
                    .then(data => {
                        if (data.task4_completed) {
                            alert('Zadanie wykonane poprawnie!');
                            window.location.href = '/';
                        } else {
                            alert('Zadanie nie zostało jeszcze wykonane poprawnie. Spróbuj ponownie.');
                        }
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                    });
            });
        });
    </script>
</head>

<body>
    <h2>Zadanie 4. (nadpisanie metody)</h2>
    <p>Ta strona symuluje zachowanie niektórych frameworków aplikacji webowych, które umożliwiają na nadpisywanie metody zapytania. Tych metod jest kilka, więc nie poddawaj się jeśli Twoja pierwsza próba się nie powiedzie.</p>

    <p>Przygotuj stronę, która po załadowaniu (bez udziału użytkownika) automatycznie usunie konto użytkownika
        (http://localhost:8081/task4).</p>

    <p>Najpierw zobacz jak działa ta strona: <a href="http://localhost:8081/task4">/task4</a></p>

    <hr>

    <details>
        <summary>Jak to działa w różnych frameworkach?</summary>
        <ul style="margin-top: 0;">
            <li>
                <a href="https://expressjs.com/en/resources/middleware/method-override.html">Method override - Express.js (Node.js)</a>
            </li>
            <li>
                <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/HiddenHttpMethodFilter.html">Http Method filter - Spring Boot (Java)</a>
            </li>
            <li>
                <a href="https://laravel.com/docs/12.x/routing#form-method-spoofing">form-method spoofing - Laravel (PHP)</a>
            </li>
        </ul>
    </details>

    <details>
        <summary>Podpowiedź 1</summary>
        <ul style="margin-top: 0;">
            <p>
                Skorzystaj z artykułu <a href="https://expressjs.com/en/resources/middleware/method-override.html">Method override - Express.js (Node.js)</a>, szukaj sekcji dotyczącej html. Nie zapomnij o <code>&lt;body onload="document.forms[0].submit()"></body></code>.
            </p>
        </ul>
    </details>

    <hr>

    <div style="display: flex; gap: 10px;">

        <div style="width: 100%;">
            <label for="siteContent"><strong>HTML Source</strong></label><br />
            <textarea id="siteContent" style="width: calc(100% - 10px); height: calc(50vh - 10px); border: 1px solid black; padding: 5px;">
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Local Content</title>
    <script>
        function log() {
            console.log('hello')
        }
    </script>
</head>

<body onload="log()">
    <p>Occaecat id anim cillum nulla enim incididunt laboris veniam enim elit anim. Anim do pariatur exercitation cupidatat velit. Commodo reprehenderit in est. Officia sint do ut. Cillum dolor elit reprehenderit voluptate occaecat ad proident fugiat quis fugiat duis id consequat commodo excepteur. Qui do dolor aute aute ut nisi culpa nulla exercitation consectetur pariatur eu id aliqua. Esse fugiat ipsum adipisicing esse ad voluptate proident sunt. Aute proident ut enim aliquip cillum magna aute et.</p>
</body>

</html>
            </textarea>
        </div>

        <div style="width: 100%;">
            <label for="resultFrame"><strong>Preview</strong></label><br />
            <iframe id="resultFrame" style="width: 100%; height: 50vh; border: 1px solid black;"></iframe>
        </div>

    </div>

    <button id="loadPage">Załaduj stronę</button>
    <button id="checkAnswer">Sprawdź odpowiedź</button>
    <button onclick="window.history.back()">Cofnij</button>
</body>

</html>
